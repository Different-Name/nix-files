# <img src="https://raw.githubusercontent.com/Different-Name/nix-files/master/assets/nix-snowflake-colours.svg" height=26> nix-files

My NixOS configuration files

> [!WARNING]
> This configuration is a work in progress - see [issues](https://github.com/Different-Name/nix-files/issues), and is intended for personal use only

- Multi host & multi user
- Flake based
- Desktop environment configurations with Hyprland
- Server configurations
- Declarative disk partitioning with [disko](https://github.com/nix-community/disko) with zfs full disk encryption
- Ephemeral root and home (state is opt in, managed by [impermanence](https://github.com/nix-community/impermanence))
- Declarative home with [home-manager](https://github.com/nix-community/home-manager)

## 1. Usage

Coming soon - see https://github.com/Different-Name/nix-files/issues/45

## 2. Structure

| Folder               | Description                |
| -------------------- | -------------------------- |
| [`system`](system)   | System level configuration |
| [`home`](home)       | Home level configuration   |
| [`secrets`](secrets) | Age secrets
| [`modules`](modules) | NixOS modules              |
| [`pkgs`](pkgs)       | Package definitions        |

### 2.1 System

[./system](system) - System level configuration

| Folder                      | Description                                                 |
| --------------------------- | ----------------------------------------------------------- |
| [`hosts`](system/hosts)     | Host specific configuration                                 |
| [`global`](system/global)   | Configurations used on all hosts                            |
| [`desktop`](system/desktop) | Configurations used on all hosts with a desktop environment |
| [`extra`](system/extra)     | Optional configurations used on one or more hosts           |

`global`, `desktop` & `extra` folders are further divided into categories:

| Folder                               | Description                                            |
| ------------------------------------ | ------------------------------------------------------ |
| [`core`](system/global/core)         | Core configurations, including boot, security, users   |
| [`hardware`](system/global/hardware) | Controls hardware, such as Bluetooth, video cards, etc |
| [`nix`](system/global/nix)           | Nix-related options                                    |
| [`programs`](system/global/programs) | `programs.*` configuration                             |
| [`services`](system/global/services) | `services.*` configurtaion                             |

#### 2.1.1 System/Hosts

[./system/hosts](system/hosts) - Host specific system configuration

Each host has 3 files

| File                                                                           | Description                                                                                 |
| ------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------- |
| [`default.nix`](system/hosts/sodium/default.nix)                               | Host specific configuration                                                                 |
| [`disk-configuration.nix`](system/hosts/sodium/disk-configuration.nix)         | Declarative partitions & file systems using [disko](https://github.com/nix-community/disko) |
| [`hardware-configuration.nix`](system/hosts/sodium/hardware-configuration.nix) | Hardware configuration generated by `nixos-generate-config`                                 |

### 2.2 Home

[./home](home/users) - Home level configuration

Each folder corresponds to a user's configuration, structured as follows:

| Folder                    | Description                                                      |
| ------------------------- | ---------------------------------------------------------------- |
| [`users`](home/users)     | User specific home configuration                                 |
| [`global`](home/global)   | Home configurations used by all users                            |
| [`desktop`](home/desktop) | Home configurations used on all users with a desktop environment |

`global` & `extra` folders are further divided into categories:

| Folder                              | Description                                    |
| ----------------------------------- | ---------------------------------------------- |
| [`assets`](home/desktop/assets)     | Assets used in the configuration (images, etc) |
| [`programs`](home/desktop/programs) | Programs, games, media, etc                    |
| [`services`](home/desktop/services) | Services                                       |

The user folder contains the configuration for the user, as well as each host that user has
This is structured in a way that each user has their own config for their host, for host specific config

For example, if `different` and `nerowy` shared the host `sodium` they would both have a `sodium.nix` file

These host files serve as an entrypoint to the home-manager configuration from the system configuration

## 3. Users

[./system/extra/users](system/extra/users) - user specific system configuration

[./home/users](home/users) - user specific home configuration

| User                                | Description                       |
| ----------------------------------- | --------------------------------- |
| [`different`](home/users/different) | Personal desktop environment user |
| [`iodine`](home/users/iodine)       | User for `iodine` server          |

## 4. Hosts

[./home/users/\<name\>/hosts](home/users/different/hosts) - host specific system configuration

[./system/hosts](system/hosts) - host specific home configuration

| Host                                  | Description               |
| ------------------------------------- | ------------------------- |
| [`sodium`](system/hosts/sodium)       | Desktop - primary machine |
| [`potassium`](system/hosts/potassium) | Laptop                    |
| [`iodine`](system/hosts/iodine)       | Server                    |

## 5. Acknowledgements

- [Graham Christensen - Erase your darlings](https://grahamc.com/blog/erase-your-darlings/)
- [Misterio77/nix-starter-configs](https://github.com/Misterio77/nix-starter-configs)
- [fufexan/dotfiles](https://github.com/fufexan/dotfiles)